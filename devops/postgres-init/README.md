# PostgreSQL æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

æœ¬ç›®å½•åŒ…å«ç”¨äºåˆå§‹åŒ– AI Run é¡¹ç›® PostgreSQL æ•°æ®åº“çš„è„šæœ¬ã€‚

## ğŸ“ æ–‡ä»¶è¯´æ˜

- `01-init-tables.sql` - ä¸»è¦åˆå§‹åŒ–è„šæœ¬ï¼Œåˆ›å»ºæ‰€æœ‰è¡¨ã€çº¦æŸã€ç´¢å¼•å’Œç¤ºä¾‹æ•°æ®
- `02-verify-init.sql` - éªŒè¯è„šæœ¬ï¼Œæ£€æŸ¥æ•°æ®åº“åˆå§‹åŒ–æ˜¯å¦æˆåŠŸ
- `README.md` - æœ¬è¯´æ˜æ–‡ä»¶

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. è¿è¡Œåˆå§‹åŒ–è„šæœ¬

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ psql å‘½ä»¤è¡Œå·¥å…·
psql -h localhost -U your_username -d your_database -f 01-init-tables.sql

# æ–¹æ³•2ï¼šä½¿ç”¨ Docker å®¹å™¨
docker exec -i your_postgres_container psql -U your_username -d your_database < 01-init-tables.sql

# æ–¹æ³•3ï¼šåœ¨ psql äº¤äº’æ¨¡å¼ä¸­
psql -h localhost -U your_username -d your_database
\i 01-init-tables.sql
```

### 2. éªŒè¯åˆå§‹åŒ–ç»“æœ

```bash
# è¿è¡ŒéªŒè¯è„šæœ¬
psql -h localhost -U your_username -d your_database -f 02-verify-init.sql
```

## ğŸ“Š åˆ›å»ºçš„è¡¨ç»“æ„

### åŸºç¡€ç³»ç»Ÿè¡¨
- `user` - ç”¨æˆ·è¡¨
- `chat` - èŠå¤©ä¼šè¯è¡¨
- `message` - æ¶ˆæ¯è¡¨
- `document` - æ–‡æ¡£è¡¨
- `suggestion` - å»ºè®®è¡¨
- `vote` - æŠ•ç¥¨è¡¨
- `stream` - æµè¡¨

### é¡¹ç›®ç®¡ç†ç³»ç»Ÿè¡¨
- `project` - é¡¹ç›®è¡¨
- `folder` - æ–‡ä»¶å¤¹è¡¨
- `test_case` - æµ‹è¯•ç”¨ä¾‹ä¸»è¡¨
- `test_case_step` - æµ‹è¯•æ­¥éª¤è¡¨
- `test_case_automation_config` - è‡ªåŠ¨åŒ–é…ç½®è¡¨
- `test_case_requirement` - ç›¸å…³éœ€æ±‚è¡¨
- `test_case_dataset` - æ•°æ®é›†è¡¨
- `test_case_run` - æµ‹è¯•è¿è¡Œè¡¨
- `test_case_known_issue` - å·²çŸ¥é—®é¢˜è¡¨
- `test_case_tag` - æµ‹è¯•ç”¨ä¾‹æ ‡ç­¾è¡¨
- `test_case_tag_relation` - æ ‡ç­¾å…³è”è¡¨
- `test_case_comment` - è¯„è®ºè¡¨
- `test_case_history` - å†å²ç‰ˆæœ¬è¡¨

### AIæ¨¡å‹é…ç½®ç³»ç»Ÿè¡¨ ğŸ¤–
- `ai_provider` - AIæä¾›è€…è¡¨ï¼ˆOpenAIã€Qwenã€xAIç­‰ï¼‰
- `ai_model` - AIæ¨¡å‹è¡¨ï¼ˆGPT-4oã€Qwen-Maxç­‰ï¼‰
- `ai_model_usage` - æ¨¡å‹ç”¨é€”æ˜ å°„è¡¨
- `ai_api_key` - APIå¯†é’¥é…ç½®è¡¨ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰

## ğŸ”§ AIæ¨¡å‹é…ç½®ç³»ç»Ÿ

### æä¾›è€…é…ç½®
è„šæœ¬ä¼šåˆ›å»ºä»¥ä¸‹AIæä¾›è€…ï¼š
- **OpenAI** - GPTç³»åˆ—æ¨¡å‹
- **Qwen (é€šä¹‰åƒé—®)** - é˜¿é‡Œäº‘å¤§æ¨¡å‹
- **xAI** - Grokç³»åˆ—æ¨¡å‹
- **ChatGPT Proxy** - ä»£ç†æœåŠ¡

### æ¨¡å‹é…ç½®
åŒ…å«12ä¸ªé¢„é…ç½®çš„AIæ¨¡å‹ï¼š
- GPT-4o, GPT-4o Mini, GPT-4 Turbo, GPT-3.5 Turbo
- Qwen Max, Qwen VL Max, Qwen Plus
- Grok-2, Grok-2 Vision, Grok-3 Mini
- GPT-4o (Proxy), GPT-4o Mini (Proxy)

### ç”¨é€”æ˜ å°„
é¢„é…ç½®çš„æ¨¡å‹ç”¨é€”ï¼š
- `chat-model` - ä¸»è¦èŠå¤©æ¨¡å‹
- `chat-model-reasoning` - æ¨ç†æ¨¡å‹
- `title-model` - æ ‡é¢˜ç”Ÿæˆæ¨¡å‹
- `artifact-model` - æ–‡æ¡£ç”Ÿæˆæ¨¡å‹
- `vision-model` - è§†è§‰æ¨¡å‹
- `code-model` - ä»£ç æ¨¡å‹
- `analysis-model` - åˆ†ææ¨¡å‹

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### APIå¯†é’¥é…ç½®
- è„šæœ¬åˆ›å»ºçš„APIå¯†é’¥é…ç½®ä½¿ç”¨å ä½ç¬¦ï¼Œ**ä¸æ˜¯çœŸå®å¯†é’¥**
- æ‰€æœ‰APIå¯†é’¥é…ç½®é»˜è®¤ä¸º `isActive = false`
- éœ€è¦é€šè¿‡ç®¡ç†ç•Œé¢æˆ–APIé…ç½®çœŸå®çš„åŠ å¯†å¯†é’¥

### é…ç½®çœŸå®APIå¯†é’¥
```sql
-- ç¤ºä¾‹ï¼šæ›´æ–°Qwen APIå¯†é’¥
UPDATE "ai_api_key" 
SET "encryptedKey" = 'YOUR_ENCRYPTED_KEY_HERE', 
    "isActive" = true 
WHERE "keyName" = 'Qwen Global Key';
```

### å®‰å…¨å»ºè®®
1. ä½¿ç”¨åŠ å¯†å·¥å…·å¯¹APIå¯†é’¥è¿›è¡ŒåŠ å¯†åå­˜å‚¨
2. å®šæœŸè½®æ¢APIå¯†é’¥
3. ä¸ºä¸åŒé¡¹ç›®/ç”¨æˆ·é…ç½®ç‹¬ç«‹çš„APIå¯†é’¥
4. ç›‘æ§APIå¯†é’¥ä½¿ç”¨æƒ…å†µ

## ğŸ” éªŒè¯æ£€æŸ¥é¡¹

éªŒè¯è„šæœ¬ä¼šæ£€æŸ¥ï¼š
- âœ… è¡¨è®°å½•æ•°é‡æ˜¯å¦æ­£ç¡®
- âœ… å¤–é”®çº¦æŸæ˜¯å¦æ­£å¸¸
- âœ… ç´¢å¼•æ˜¯å¦åˆ›å»ºæˆåŠŸ
- âœ… AIæ¨¡å‹é…ç½®æ˜¯å¦å®Œæ•´
- âœ… æ•°æ®å®Œæ•´æ€§éªŒè¯

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

è„šæœ¬åŒ…å«ä»¥ä¸‹æ€§èƒ½ä¼˜åŒ–ï¼š
- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•
- å¤–é”®çº¦æŸç¡®ä¿æ•°æ®å®Œæ•´æ€§
- JSONå­—æ®µç”¨äºçµæ´»é…ç½®å­˜å‚¨
- åˆ†åŒºå‹å¥½çš„æ—¶é—´æˆ³å­—æ®µ

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

å¦‚éœ€æ›´æ–°æ•°æ®åº“ç»“æ„ï¼š
1. å¤‡ä»½ç°æœ‰æ•°æ®
2. åˆ›å»ºè¿ç§»è„šæœ¬
3. æµ‹è¯•è¿ç§»è¿‡ç¨‹
4. æ›´æ–°åˆå§‹åŒ–è„šæœ¬

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æƒé™é”™è¯¯** - ç¡®ä¿æ•°æ®åº“ç”¨æˆ·æœ‰åˆ›å»ºè¡¨çš„æƒé™
2. **æ‰©å±•ç¼ºå¤±** - ç¡®ä¿å®‰è£…äº† `uuid-ossp` å’Œ `pg_trgm` æ‰©å±•
3. **å­—ç¬¦ç¼–ç ** - ç¡®ä¿æ•°æ®åº“ä½¿ç”¨ UTF-8 ç¼–ç 
4. **å¤–é”®çº¦æŸå¤±è´¥** - æ£€æŸ¥æ•°æ®å®Œæ•´æ€§

### æ¸…ç†å’Œé‡æ–°åˆå§‹åŒ–
```sql
-- è­¦å‘Šï¼šè¿™å°†åˆ é™¤æ‰€æœ‰æ•°æ®ï¼
DROP SCHEMA public CASCADE;
CREATE SCHEMA public;
-- ç„¶åé‡æ–°è¿è¡Œåˆå§‹åŒ–è„šæœ¬
```

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿæˆ–æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£ã€‚
